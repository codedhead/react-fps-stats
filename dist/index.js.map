{"version":3,"file":"index.js","sources":["../src/index.tsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\n\r\ntype Props = {\r\n  color?: string;\r\n  fontSize?: string;\r\n  capacity: number;\r\n};\r\n\r\nconst baseColor = \"rgba(0,255,255,1)\";\r\n\r\nexport default function FPSStat({ color, fontSize, capacity }: Props): JSX.Element {\r\n  const [fps, setFps] = useState([0]);\r\n\r\n  useEffect(() => {\r\n    let afRequest = 0;\r\n    const currentTime = +new Date();\r\n\r\n    let prevTime = currentTime;\r\n    let frame = 0;\r\n    let fpsList = [0];\r\n\r\n    let calcFPS = () => {\r\n      const currentTime = +new Date();\r\n      frame = frame + 1;\r\n\r\n      if (currentTime > prevTime + 1000) {\r\n        let fpsNow = Math.round((frame * 1000) / (currentTime - prevTime));\r\n\r\n        fpsList = fpsList.concat(fpsNow);\r\n\r\n        if (fpsList.length > capacity) {\r\n          fpsList = fpsList.slice(1, capacity + 2);\r\n        }\r\n\r\n        setFps(fpsList);\r\n        //console.log(fpsList);\r\n        frame = 0;\r\n        prevTime = currentTime;\r\n      }\r\n\r\n      afRequest = requestAnimationFrame(calcFPS);\r\n    };\r\n\r\n    afRequest = requestAnimationFrame(calcFPS);\r\n\r\n    return () => {\r\n      cancelAnimationFrame(afRequest);\r\n    };\r\n  }, []);\r\n\r\n  const wrapperStyle = {\r\n    zIndex: 100,\r\n    display: \"flex\",\r\n    flexDirection: \"column\" as \"column\",\r\n    height: \"100%\",\r\n    width: \"100%\",\r\n    padding: \"3px\",\r\n    color: color == undefined ? baseColor : color,\r\n    fontSize: fontSize == undefined ? \"0.75em\" : fontSize,\r\n    fontFamily: \"Helvetica, Arial, sans-serif\",\r\n    fontWeight: \"bold\" as \"bold\",\r\n  };\r\n\r\n  const maxFps = Math.max.apply(Math.max, fps);\r\n  const barWidth = 100 / capacity;\r\n\r\n  return (\r\n    <div style={wrapperStyle}>\r\n      <span style={{ zIndex: 101 }}>{fps[fps.length - 1]} FPS</span>\r\n      <svg style={{ height: \"100%\", width: \"100%\", overflow: \"visible\" }}>\r\n        {fps.map((fpsNow, i) => {\r\n          const height = fpsNow == 0 ? 0 : (100 * fpsNow) / maxFps;\r\n          return (\r\n            <rect\r\n              key={i}\r\n              x={`${100 - barWidth - i * barWidth}%`}\r\n              y={`${100 - height}%`}\r\n              width={`${barWidth * 1.2}%`}\r\n              height={`${height}%`}\r\n              fill={color == undefined ? baseColor : color}\r\n            />\r\n          );\r\n        })}\r\n      </svg>\r\n    </div>\r\n  );\r\n}\r\n"],"names":["useState","useEffect","React"],"mappings":"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"}